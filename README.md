<div align="center">
<h1> SCAikido - Software Composition Analysis Tool </h1>

![Version](https://img.shields.io/badge/version-1.1.0-blue.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)
![Shell](https://img.shields.io/badge/shell-bash-yellow.svg)
![Engine](https://img.shields.io/badge/engine-node.js-green.svg)

**Automated vulnerability scanner using Syft SBOM and Aikido Intel database.**

</div>

---

## üö® IMPORTANT DISCLAIMER

> **‚ö†Ô∏è LIMITED VULNERABILITY DATABASE COVERAGE**
> 
> This tool uses the [Aikido Intel](https://github.com/AikidoSec/intel) vulnerability database. While it excels at catching vulnerabilities **before they get CVE numbers**, it is not a replacement for standard CVE databases.
>
> ### Known Limitations:
> - ‚ùå **Older packages** may not be covered.
>
> ### ‚úÖ Recommendation:
> **DO NOT use this as your only security scanner!** Always complement with:
> - üîπ `npm audit` / `yarn audit` (Node.js)
> - üîπ `pip-audit` (Python)
> - üîπ `trivy` (General Container)
>
> **Use SCAikido as a specialized "early warning" layer alongside comprehensive scanners.**

---

## ‚ö° Key Features

- **üõ°Ô∏è Smart Ecosystem Validation:** Automatically maps SBOM package types (e.g., `conan`, `npm`, `gem`) to their correct languages. This prevents false positives, such as confusing a C++ `openssl` library with a Ruby `openssl` gem.
- **üöÄ High Performance:** Utilizes a Node.js engine for rapid indexing and version comparison.
- **üîç Universal Name Matching:** Implements a robust matching strategy (Exact, Lowercase, Normalized, Substring) to find vulnerabilities even if naming conventions differ.
- **üìä Detailed Reporting:** Generates JSON output with severity statistics, package types, and language grouping.

---

## üìã How It Works

1. **Input:** You generate an SBOM (Software Bill of Materials) using `syft` or similar tools.
2. **Indexing:** SCAikido downloads and builds a high-speed memory index of the Aikido database.
3. **Analysis:** It iterates through your SBOM, verifying:
   - **Version Ranges:** Checks if your version falls within vulnerable ranges.
   - **Language Compatibility:** Ensures the vulnerability language matches the package type (e.g., `maven` packages are only checked against Java vulnerabilities).
4. **Report:** Generates a detailed JSON report with findings and remediation advice.

---

## üì¶ Prerequisites

The script requires the following tools installed in your environment:

```bash
# 1. Syft (Required to generate the input SBOM)
brew install syft  # macOS
# or: curl -sSfL https://raw.githubusercontent.com/anchore/syft/main/install.sh | sh

# 2. jq (JSON processor)
brew install jq    # macOS
# or: sudo apt-get install jq

# 3. Node.js (Required for the analysis engine)
brew install node  # macOS
# or: sudo apt-get install nodejs

# 4. Git (To fetch the database)
# Usually pre-installed
```

---

## üöÄ Installation

```bash
git clone https://github.com/yourusername/scaikido.git
cd scaikido
chmod +x SCAikido.sh
```

---

## üíª Usage

SCAikido requires a JSON SBOM file generated by Syft.

### 1. Generate the SBOM
Run Syft on your project directory:
```bash
syft packages dir:. -o json > sbom.json
```

### 2. Run the Scan
Pass the SBOM file to the script:

```bash
# Standard scan
./SCAikido.sh sbom.json

# Verbose mode (shows language compatibility checks)
./SCAikido.sh -v sbom.json

# Custom output file
./SCAikido.sh -o my_audit.json sbom.json

# Debug mode (inspect version comparison logic)
./SCAikido.sh -d sbom.json
```

---

## üìÑ Output Example

The tool generates a JSON file (default: `vulnerability_report.json`). Note the `package_type` vs `language` validation:

```json
{
  "scan_date": "2026-01-10T20:50:36Z",
  "sbom_file": "test-C++/sbom.json",
  "total_packages": 3,
  "vulnerable_packages": 2,
  "vulnerabilities": [
    {
      "package": "fast-dds",
      "version": "2.8.0",
      "package_type": "conan",
      "language": "c++",
      "vulnerability_id": "AIKIDO-2025-11005",
      "title": "Affected versions of the package verify expired JWT tokens, allowing unauthorized access.",
      "severity": "MEDIUM",
      "aikido_score": 45,
      "cve": "CVE-2025-24807",
      "cwe": [
        "CWE-345"
      ],
      "affected_versions": [
        [
          "0.0.1",
          "2.6.9"
        ],
        [
          "2.7.0",
          "2.10.6"
        ],
        [
          "2.11.0",
          "2.14.4"
        ],
        [
          "3.0.0",
          "3.0.1"
        ],
        [
          "3.1.0",
          "3.1.1"
        ]
      ],
      "patched_versions": [
        "2.6.10",
        "2.10.7",
        "2.14.5",
        "3.0.2",
        "3.1.2"
      ],
      "description": "Affected versions of the package verify expired JWT tokens, allowing unauthorized access.",
      "how_to_fix": "Upgrade the `eProsima.Fast-DDS` library to the patch version.",
      "does_this_affect_me": "You are affected if you are using a version that falls within the vulnerable range.",
      "vulnerable_to": "Insufficient Verification of Data Authenticity",
      "changelog": "https://github.com/eProsima/Fast-DDS/releases/tag/v2.14.5",
      "published": "2025-12-30"
    },
    {
      "package": "fast-dds",
      "version": "2.8.0",
      "package_type": "conan",
      "language": "c++",
      "vulnerability_id": "AIKIDO-2025-11006",
      "title": "Affected versions of the package are vulnerable to CVE-2025-62599, CVE-2025-62600, CVE-2025-62601, CVE-2025-62602, CVE-2025-62603, and CVE-2025-64098 by fully refactoring the built-in deserializers in `CDRMessage`. The update introduces additional safety checks, including protections against arithmetic overflows during length validation, to ensure robust and secure deserialization. Also CVE-2025-62799, CVE-2025-64438 and CVE-2025-65016 were fixed.",
      "severity": "MEDIUM",
      "aikido_score": 50,
      "cve": "CVE-2025-62599",
      "cwe": [
        "CWE-190"
      ],
      "affected_versions": [
        [
          "0.0.1",
          "2.6.10"
        ],
        [
          "2.7.0",
          "3.4.0"
        ]
      ],
      "patched_versions": [
        "2.6.11",
        "3.4.1"
      ],
      "description": "Affected versions of the package are vulnerable to CVE-2025-62599, CVE-2025-62600, CVE-2025-62601, CVE-2025-62602, CVE-2025-62603, and CVE-2025-64098 by fully refactoring the built-in deserializers in `CDRMessage`. The update introduces additional safety checks, including protections against arithmetic overflows during length validation, to ensure robust and secure deserialization. Also CVE-2025-62799, CVE-2025-64438 and CVE-2025-65016 were fixed.",
      "how_to_fix": "Upgrade the `eProsima.Fast-DDS` library to the patch version.",
      "does_this_affect_me": "You are affected if you are using a version that falls within the vulnerable range.",
      "vulnerable_to": "Integer Overflow",
      "changelog": "https://github.com/eProsima/Fast-DDS/releases/tag/v3.4.1",
      "published": "2025-12-30"
    }
  ],
  "statistics": {
    "critical": 0,
    "high": 0,
    "medium": 2,
    "low": 0
  },
  "by_language": [
    {
      "language": "c++",
      "count": 2,
      "packages": [
        "fast-dds"
      ]
    }
  ]
}

```

---

## ü§ù Contributing

Contributions are welcome!
- **Bug Reports:** Please attach the `sbom.json` (redacted if necessary) that caused the issue.
- **Pull Requests:** Ensure the Node.js helper scripts are efficient and the `lang_map.json` is updated if adding new package managers.

---

## üôè Acknowledgments

- [Aikido Security](https://github.com/AikidoSec/intel) - Vulnerability database
- [Anchore Syft](https://github.com/anchore/syft) - SBOM generation

---
<div align="center">

Made with ‚ù§Ô∏è by [TryckMaster](https://github.com/DaniloSilvaDeOliveira)

</div>
